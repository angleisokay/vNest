import"https://cdn.jsdelivr.net/npm/markdown-it@14.1.0/dist/markdown-it.min.js";let md=markdownit();function setUpStyles(){let e=document.styleSheets[0];if(!e){let t=document.createElement("style");document.head.appendChild(t),e=t.sheet}return e}function getRule(e){let t=setUpStyles();for(let l=0;l<t.cssRules.length;l++)if(t.cssRules[l].selectorText===e)return t.cssRules[l];return t.insertRule(`${e} {}`,t.cssRules.length),t.cssRules[t.cssRules.length-1]}function updateProps(e,t={},l={}){for(let n in t)if("textContent"===n){let r=md.render(t[n]);e.innerHTML!==r&&(e.innerHTML=r)}else if("className"===n)e.className!==t[n]&&(e.className=t[n]);else if("clickAction"===n)l[n]&&e.removeEventListener("click",l[n]),e.addEventListener("click",t[n]);else if("style"===n)for(let i in t.style)e.style[i]=t.style[i];else e.setAttribute(n,t[n]);for(let s in l)if(!(s in t)){if("className"===s)e.className="";else if("clickAction"===s)e.removeEventListener("click",l[s]);else if("style"===s)for(let a in l.style)e.style[a]="";else e.removeAttribute(s)}}function createRealElement(e){let t=document.createElement(e.element);for(let l in e.properties)if("className"===l)t.className=e.properties[l];else if("textContent"===l)t.innerHTML=md.render(e.properties[l]);else if("clickAction"===l)t.addEventListener("click",e.properties[l]);else if("style"===l){let n=e.properties[l];for(let r in n)t.style[r]=n[r]}else t.setAttribute(l,e.properties[l]);return e.children&&e.children.forEach(e=>{t.appendChild(createRealElement(e))}),t}function updateElement(e,t,l,n=0){let r=e.childNodes[n];if(!l){e.appendChild(createRealElement(t));return}if(!t){e.removeChild(r);return}if(t.element!==l.element){e.replaceChild(createRealElement(t),r);return}updateProps(r,t.properties,l.properties);let i=t.children?t.children.length:0,s=l.children?l.children.length:0,a=Math.max(i,s);for(let c=0;c<a;c++)updateElement(r,t.children[c],l.children[c],c)}let vNest={createPage(){let e=document.createElement("div");e.className="vNestPage";let t=null;function l(l){t?updateElement(e,l,t):e.appendChild(createRealElement(l)),t=l}let n=[];return{page:e,createElement(l,r={},i=[]){let s={element:l,properties:r,children:i};n.push(s);let a=n.length-1,c=e.childNodes[a];if(c){if(c.tagName.toLowerCase()!==s.element)e.replaceChild(createRealElement(s),c);else if(s.properties.textContent){let d=md.render(s.properties.textContent);c.innerHTML!==d&&(c.innerHTML=d)}}else e.appendChild(createRealElement(s));return t=[...n],e.childNodes[a]},modifyProperty(e,t={}){let l=document.getElementById(e);if(l)for(let n in t)null===t[n]||void 0===t[n]?l[n]="":l[n]=t[n]},idStyle(e,t={}){let l=document.getElementById(e);if(l)for(let n in t)null===t[n]||void 0===t[n]?l.style[n]="":l.style[n]=t[n]},classStyle(e,t={}){let l=getRule(`.${e}`);for(let n in t)null===t[n]||void 0===t[n]?l.style[n]="":l.style[n]=t[n]},pageStyle(e={}){let t=getRule(".vNestPage");for(let l in e)null===e[l]||void 0===e[l]?t.style[l]="":t.style[l]=e[l]},customStyle(e,t={}){let l=getRule(e);for(let n in t)null===t[n]||void 0===t[n]?l.style[n]="":l.style[n]=t[n]},docStyle(e={}){let t=getRule("body");for(let l in e)null===e[l]||void 0===e[l]?t.style[l]="":t.style[l]=e[l]},modifyHead(e={}){if(!document.head){let t=document.createElement("head"),l=document.body;l?document.documentElement.insertBefore(t,l):document.documentElement.appendChild(t)}"title"in e&&(document.title=e.title||""),Array.isArray(e.meta)&&e.meta.forEach(({name:e,content:t,property:l,charset:n,httpEquiv:r})=>{let i="";e?i=`meta[name="${e}"]`:l?i=`meta[property="${l}"]`:n?i="meta[charset]":r&&(i=`meta[http-equiv="${r}"]`);let s=i?document.head.querySelector(i):null;s||(s=document.createElement("meta"),document.head.appendChild(s)),e&&s.setAttribute("name",e),l&&s.setAttribute("property",l),n&&s.setAttribute("charset",n),r&&s.setAttribute("http-equiv",r),s.setAttribute("content",t||"")}),Array.isArray(e.link)&&e.link.forEach(e=>{let t=document.createElement("link");Object.entries(e).forEach(([e,l])=>{null!=l&&t.setAttribute(e,l)}),document.head.appendChild(t)}),Array.isArray(e.script)&&e.script.forEach(e=>{let t=document.createElement("script");Object.entries(e).forEach(([e,l])=>{null!=l&&t.setAttribute(e,l)}),document.head.appendChild(t)}),Object.entries(e).forEach(([e,t])=>{"title"!==e&&"meta"!==e&&"link"!==e&&"script"!==e&&(null==t?document.documentElement.removeAttribute(e):document.documentElement.setAttribute(e,t))})}}}};export default vNest;